% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/01_train_kmeans_qc.R
\name{train_kmeans_qc}
\alias{train_kmeans_qc}
\title{Train a k-means model with multi-criteria QC (Elbow, Silhouette, Gap)}
\usage{
train_kmeans_qc(mat, k.max = 10, nstart = 25, B = 100, seed = 123)
}
\arguments{
\item{mat}{A numeric matrix or data frame with features in rows and samples in columns.}

\item{k.max}{Maximum number of clusters to evaluate (default: 10).}

\item{nstart}{Number of random initializations for k-means (default: 25).}

\item{B}{Number of bootstrap samples for the Gap Statistic (default: 100).}

\item{seed}{Random seed for reproducibility (default: 123).}
}
\value{
A list containing:
\describe{
  \item{k_elbow}{Optimal k from the Elbow method.}
  \item{k_silhouette}{Optimal k from the Silhouette method.}
  \item{k_gap}{Optimal k from the Gap Statistic.}
  \item{optimal_k}{Final optimal k (majority vote).}
  \item{plots}{A combined patchwork object with the three QC plots.}
  \item{kmeans_model}{The final k-means model.}
  \item{clusters}{Cluster assignments for each sample.}
}
}
\description{
This function performs a complete k-means clustering workflow including:
data preprocessing, three independent quality-control criteria (Elbow, 
Silhouette, Gap Statistic), automatic extraction of the optimal number 
of clusters, majority voting across QC metrics, and final k-means training.
}
\details{
The function returns both the QC metrics and the final clustering model,
along with the diagnostic plots used to assess cluster stability.


The function applies the following steps:
\itemize{
  \item Transposition of the matrix so that samples are in rows.
  \item Standardization using \code{scale()}.
  \item Elbow method using total within-cluster sum of squares.
  \item Silhouette method using average silhouette width.
  \item Gap Statistic using bootstrap resampling.
  \item Automatic extraction of the best \code{k} for each QC method.
  \item Majority vote to determine the final optimal number of clusters.
  \item Final k-means training with the selected \code{k}.
}
}
\examples{
\dontrun{
  set.seed(123)
  mat <- matrix(rnorm(1000), nrow = 100, ncol = 10)
  res <- train_kmeans_qc(mat)
  res$optimal_k
  res$clusters
  res$plots
}

}
