% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/07_qc_geometric_separation.R
\name{qc_geometric_separation}
\alias{qc_geometric_separation}
\title{Geometric QC: separation vs compactness across k}
\usage{
qc_geometric_separation(
  mat,
  k_range = 2:10,
  optimal_k = NULL,
  nstart = 20,
  palette = "steelblue",
  base_size = 14,
  main = "Proportion of explained variance by cluster"
)
}
\arguments{
\item{mat}{A numeric matrix or data frame (samples in rows).}

\item{k_range}{A vector of k values to evaluate (default: 2:10).}

\item{optimal_k}{Optional value of k to highlight with a vertical line.}

\item{nstart}{Number of random initializations for k-means (default: 20).}

\item{palette}{Color for the line and points (default: "steelblue").}

\item{base_size}{Base font size for the plot (default: 14).}

\item{main}{Title of the plot.}
}
\value{
A list containing:
\describe{
  \item{df}{Data frame with k, betweenSS, totalSS, ratio.}
  \item{plot}{A ggplot2 object.}
}
}
\description{
This function computes the geometric quality-control metric
BetweenSS / TotalSS for a range of k values in k-means clustering.
It returns both the data frame and a ggplot2 visualization.
}
\examples{
\dontrun{
  mat_scaled <- scale(t(mat))
  qc <- qc_geometric_separation(mat_scaled, k_range = 2:10, optimal_k = 3)
  qc$plot
}

}
